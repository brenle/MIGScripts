{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MIGScripts An assortment of scripts which I've created to help with Microsoft Information Governance (MIG) and Records Management (RM) scenarios. Disclaimer These scripts are provided as working (usually) examples , as-is, with no support . However, if you do find an issue with any of theses scripts, feel free to submit an issue or fork and submit a pull request with any updates. Use these scripts at your own risk . Ensure you review the entire script and understand exactly what it does before using. Test the scripts within a demo tenant or test environment before using in production. Microsoft and I are not responsible for any result of using these scripts . Running the scripts Given the scripts connect to resources in Microsoft 365, most of these scripts will require some prerequisite modules, such as the Exchange Online PowerShell module . I will note what is required and/or optional for each script. Since the scripts are meant to be simple examples and not production scripts, I do not sign my scripts. In order to run these scripts, you will need to set the execution policy to unrestricted within PowerShell on your machine: Set-ExecutionPolicy Unrestricted Additionally, if you download any script from the internet and attempt to run it, you will first need to unblock the file first. Unblock-File <filename>","title":"Home"},{"location":"#welcome-to-migscripts","text":"An assortment of scripts which I've created to help with Microsoft Information Governance (MIG) and Records Management (RM) scenarios.","title":"Welcome to MIGScripts"},{"location":"#disclaimer","text":"These scripts are provided as working (usually) examples , as-is, with no support . However, if you do find an issue with any of theses scripts, feel free to submit an issue or fork and submit a pull request with any updates. Use these scripts at your own risk . Ensure you review the entire script and understand exactly what it does before using. Test the scripts within a demo tenant or test environment before using in production. Microsoft and I are not responsible for any result of using these scripts .","title":"Disclaimer"},{"location":"#running-the-scripts","text":"Given the scripts connect to resources in Microsoft 365, most of these scripts will require some prerequisite modules, such as the Exchange Online PowerShell module . I will note what is required and/or optional for each script. Since the scripts are meant to be simple examples and not production scripts, I do not sign my scripts. In order to run these scripts, you will need to set the execution policy to unrestricted within PowerShell on your machine: Set-ExecutionPolicy Unrestricted Additionally, if you download any script from the internet and attempt to run it, you will first need to unblock the file first. Unblock-File <filename>","title":"Running the scripts"},{"location":"exo/validate-adaptivescopesopathquery/","text":"Validate-AdaptiveScopesOPATHQuery.ps1 This script can be used to validate advanced adaptive scopes queries written in OPATH. Requirements Ensure you've read the disclaimer and running the scripts sections of this documentation. To run this script, you must have the Exchange Online PowerShell module installed. You will be required to at least connect to Exchange Online, and will need permissions that allow you to run Get-Mailbox and Get-Recipient . To connect to Exchange Online using the Exchange Online PowerShell module, run: Connect-ExchangeOnline If you use -adaptiveScopeName you will also need to connect to Security and Compliance Center PowerShell, and will need permissions that allow ou to run Get-AdaptiveScope . To connect to the Security and Compliance Center PowerShell module, run: Connect-IPPSession Usage To run the script and enter an OPATH query using a GUI: .\\Validate-AdaptiveScopesOPATHQuery.ps1 To run the script and extract an OPATH query from an existing scope: .\\Validate-AdaptiveScopesOPATHQuery.ps1 -adaptiveScopeName [name of scope] To run the script and supply a query via parameter: .\\Validate-AdaptiveScopesOPATHQuery.ps1 -rawQuery [OPATH query] -scopeType [User | Group] NOTE: You must include -scopeType when using -rawQuery Optional parameters -exportCSV : Exports full output of objects that match OPATH query to CSV file. No value is required with this parameter. -csvPath [path] : Path to export Csv. Default value is c:\\temp\\ Download Access the script here","title":"Validate-AdaptiveScopesOPATHQuery.ps1"},{"location":"exo/validate-adaptivescopesopathquery/#validate-adaptivescopesopathqueryps1","text":"This script can be used to validate advanced adaptive scopes queries written in OPATH.","title":"Validate-AdaptiveScopesOPATHQuery.ps1"},{"location":"exo/validate-adaptivescopesopathquery/#requirements","text":"Ensure you've read the disclaimer and running the scripts sections of this documentation. To run this script, you must have the Exchange Online PowerShell module installed. You will be required to at least connect to Exchange Online, and will need permissions that allow you to run Get-Mailbox and Get-Recipient . To connect to Exchange Online using the Exchange Online PowerShell module, run: Connect-ExchangeOnline If you use -adaptiveScopeName you will also need to connect to Security and Compliance Center PowerShell, and will need permissions that allow ou to run Get-AdaptiveScope . To connect to the Security and Compliance Center PowerShell module, run: Connect-IPPSession","title":"Requirements"},{"location":"exo/validate-adaptivescopesopathquery/#usage","text":"To run the script and enter an OPATH query using a GUI: .\\Validate-AdaptiveScopesOPATHQuery.ps1 To run the script and extract an OPATH query from an existing scope: .\\Validate-AdaptiveScopesOPATHQuery.ps1 -adaptiveScopeName [name of scope] To run the script and supply a query via parameter: .\\Validate-AdaptiveScopesOPATHQuery.ps1 -rawQuery [OPATH query] -scopeType [User | Group] NOTE: You must include -scopeType when using -rawQuery","title":"Usage"},{"location":"exo/validate-adaptivescopesopathquery/#optional-parameters","text":"-exportCSV : Exports full output of objects that match OPATH query to CSV file. No value is required with this parameter. -csvPath [path] : Path to export Csv. Default value is c:\\temp\\","title":"Optional parameters"},{"location":"exo/validate-adaptivescopesopathquery/#download","text":"Access the script here","title":"Download"}]}