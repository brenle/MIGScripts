{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MIGScripts \u2693\ufe0e An assortment of scripts which I've created to help with Microsoft Information Governance (MIG) and Records Management (RM) scenarios. Disclaimer \u2693\ufe0e These scripts are provided as working (usually) examples , as-is, with no support . However, if you do find an issue with any of theses scripts, feel free to submit an issue or fork and submit a pull request with any updates. Use these scripts at your own risk . Ensure you review the entire script and understand exactly what it does before using. Test the scripts within a demo tenant or test environment before using in production. Warning I am not responsible for any negative result from using these scripts. It is your responsibility to fully review and understand what the script will do befor running in your environment. Running the scripts \u2693\ufe0e Given the scripts connect to resources in Microsoft 365, most of these scripts will require some prerequisite modules, such as the Exchange Online PowerShell module . I will note what is required and/or optional for each script. Since the scripts are meant to be simple examples and not production scripts, I do not sign my scripts. In order to run these scripts, you will need to set the execution policy to unrestricted within PowerShell on your machine: Set-ExecutionPolicy Unrestricted Additionally, if you download any script from the internet and attempt to run it, you will first need to unblock the file first. Unblock-File < filename >","title":"Home"},{"location":"#welcome-to-migscripts","text":"An assortment of scripts which I've created to help with Microsoft Information Governance (MIG) and Records Management (RM) scenarios.","title":"Welcome to MIGScripts"},{"location":"#disclaimer","text":"These scripts are provided as working (usually) examples , as-is, with no support . However, if you do find an issue with any of theses scripts, feel free to submit an issue or fork and submit a pull request with any updates. Use these scripts at your own risk . Ensure you review the entire script and understand exactly what it does before using. Test the scripts within a demo tenant or test environment before using in production. Warning I am not responsible for any negative result from using these scripts. It is your responsibility to fully review and understand what the script will do befor running in your environment.","title":"Disclaimer"},{"location":"#running-the-scripts","text":"Given the scripts connect to resources in Microsoft 365, most of these scripts will require some prerequisite modules, such as the Exchange Online PowerShell module . I will note what is required and/or optional for each script. Since the scripts are meant to be simple examples and not production scripts, I do not sign my scripts. In order to run these scripts, you will need to set the execution policy to unrestricted within PowerShell on your machine: Set-ExecutionPolicy Unrestricted Additionally, if you download any script from the internet and attempt to run it, you will first need to unblock the file first. Unblock-File < filename >","title":"Running the scripts"},{"location":"exo/validate-adaptivescopesopathquery/","text":"Validate-AdaptiveScopesOPATHQuery.ps1 \u2693\ufe0e This script can be used to validate advanced adaptive scopes queries written in OPATH. Requirements \u2693\ufe0e Ensure you've read the disclaimer and running the scripts sections of this documentation. To run this script, you must have the Exchange Online PowerShell module installed. You will be required to at least connect to Exchange Online, and will need permissions that allow you to run Get-Mailbox and Get-Recipient . To connect to Exchange Online using the Exchange Online PowerShell module, run: Connect-ExchangeOnline If you use -adaptiveScopeName you will also need to connect to Security and Compliance Center PowerShell, and will need permissions that allow ou to run Get-AdaptiveScope . To connect to the Security and Compliance Center PowerShell module, run: Connect-IPPSSession Usage \u2693\ufe0e To run the script and enter an OPATH query using a GUI \u2693\ufe0e .\\ Validate-AdaptiveScopesOPATHQuery . ps1 To run the script and extract an OPATH query from an existing scope \u2693\ufe0e .\\ Validate-AdaptiveScopesOPATHQuery . ps1 -adaptiveScopeName [name of scope] To run the script and supply a query via parameter \u2693\ufe0e .\\ Validate-AdaptiveScopesOPATHQuery . ps1 -rawQuery [OPATH query] -scopeType [ User | Group ] Note You must include -scopeType when using -rawQuery Optional parameters \u2693\ufe0e -exportCSV : Exports full output of objects that match OPATH query to CSV file. No value is required with this parameter. -csvPath [path] : Path to export Csv. Default value is c:\\temp\\ Known Limitations \u2693\ufe0e Some properties exist for Get-Mailbox and some for Get-Recipient . The script attempts to see if the query works with Get-Mailbox first, then attempts to use Get-Recipient . However, if properties are mixed (one that works only with Get-Mailbox and one that works only with Get-Recipient ), the script will not be able to validate the query although mixing properties is supported with adaptive policy scopes. Review which cmdlet each property works with here . Screenshots \u2693\ufe0e Figure 1: Executing Validate-AdaptiveScopesOPATHQuery.ps1 with no parameters. Figure 2: Validate-AdaptiveScopesOPATHQuery.ps1 results. Download \u2693\ufe0e Access the script here Changelog \u2693\ufe0e January 5th, 2022 \u2693\ufe0e Added support for SharedMailbox, EquipmentMailbox and RoomMailbox recipient types Rewrote analysis to provide stats for number of shared/resource mailboxes in addition to inactive/incorrectly licensed November 7th, 2021 \u2693\ufe0e Updated documentation link Improved detection of inactive mailboxes Added total number of inactive mailboxes in query because of improvements Added detection of improperly licensed users ( Experimental! This may incorrectly report depending on the license or add-on ) November 4th, 2021 \u2693\ufe0e Initial release","title":"Validate-AdaptiveScopesOPATHQuery.ps1"},{"location":"exo/validate-adaptivescopesopathquery/#validate-adaptivescopesopathqueryps1","text":"This script can be used to validate advanced adaptive scopes queries written in OPATH.","title":"Validate-AdaptiveScopesOPATHQuery.ps1"},{"location":"exo/validate-adaptivescopesopathquery/#requirements","text":"Ensure you've read the disclaimer and running the scripts sections of this documentation. To run this script, you must have the Exchange Online PowerShell module installed. You will be required to at least connect to Exchange Online, and will need permissions that allow you to run Get-Mailbox and Get-Recipient . To connect to Exchange Online using the Exchange Online PowerShell module, run: Connect-ExchangeOnline If you use -adaptiveScopeName you will also need to connect to Security and Compliance Center PowerShell, and will need permissions that allow ou to run Get-AdaptiveScope . To connect to the Security and Compliance Center PowerShell module, run: Connect-IPPSSession","title":"Requirements"},{"location":"exo/validate-adaptivescopesopathquery/#usage","text":"","title":"Usage"},{"location":"exo/validate-adaptivescopesopathquery/#to-run-the-script-and-enter-an-opath-query-using-a-gui","text":".\\ Validate-AdaptiveScopesOPATHQuery . ps1","title":"To run the script and enter an OPATH query using a GUI"},{"location":"exo/validate-adaptivescopesopathquery/#to-run-the-script-and-extract-an-opath-query-from-an-existing-scope","text":".\\ Validate-AdaptiveScopesOPATHQuery . ps1 -adaptiveScopeName [name of scope]","title":"To run the script and extract an OPATH query from an existing scope"},{"location":"exo/validate-adaptivescopesopathquery/#to-run-the-script-and-supply-a-query-via-parameter","text":".\\ Validate-AdaptiveScopesOPATHQuery . ps1 -rawQuery [OPATH query] -scopeType [ User | Group ] Note You must include -scopeType when using -rawQuery","title":"To run the script and supply a query via parameter"},{"location":"exo/validate-adaptivescopesopathquery/#optional-parameters","text":"-exportCSV : Exports full output of objects that match OPATH query to CSV file. No value is required with this parameter. -csvPath [path] : Path to export Csv. Default value is c:\\temp\\","title":"Optional parameters"},{"location":"exo/validate-adaptivescopesopathquery/#known-limitations","text":"Some properties exist for Get-Mailbox and some for Get-Recipient . The script attempts to see if the query works with Get-Mailbox first, then attempts to use Get-Recipient . However, if properties are mixed (one that works only with Get-Mailbox and one that works only with Get-Recipient ), the script will not be able to validate the query although mixing properties is supported with adaptive policy scopes. Review which cmdlet each property works with here .","title":"Known Limitations"},{"location":"exo/validate-adaptivescopesopathquery/#screenshots","text":"Figure 1: Executing Validate-AdaptiveScopesOPATHQuery.ps1 with no parameters. Figure 2: Validate-AdaptiveScopesOPATHQuery.ps1 results.","title":"Screenshots"},{"location":"exo/validate-adaptivescopesopathquery/#download","text":"Access the script here","title":"Download"},{"location":"exo/validate-adaptivescopesopathquery/#changelog","text":"","title":"Changelog"},{"location":"exo/validate-adaptivescopesopathquery/#january-5th-2022","text":"Added support for SharedMailbox, EquipmentMailbox and RoomMailbox recipient types Rewrote analysis to provide stats for number of shared/resource mailboxes in addition to inactive/incorrectly licensed","title":"January 5th, 2022"},{"location":"exo/validate-adaptivescopesopathquery/#november-7th-2021","text":"Updated documentation link Improved detection of inactive mailboxes Added total number of inactive mailboxes in query because of improvements Added detection of improperly licensed users ( Experimental! This may incorrectly report depending on the license or add-on )","title":"November 7th, 2021"},{"location":"exo/validate-adaptivescopesopathquery/#november-4th-2021","text":"Initial release","title":"November 4th, 2021"}]}